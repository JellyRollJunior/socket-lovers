generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(uuid())
  username String @unique
  password String
  bio      String @default("Thank you for visiting my profile")
  avatar   String @default("https://bpchhgiihbdqtamrfehs.supabase.co/storage/v1/object/public/avatar/default/avatar.png")

  chats    Chat[]
  messages Message[]
}

model Message {
  id       String   @id @default(uuid())
  content  String
  sendTime DateTime @default(now())

  sender        User   @relation(fields: [senderId], references: [id])
  senderId      String
  chat          Chat   @relation(fields: [chatId], references: [id])
  chatId        String
  latestMessage Chat?  @relation(name: "latestMessage")
}

model Chat {
  id   String @id @default(uuid())
  name String

  latestMessage   Message? @relation(name: "latestMessage", fields: [latestMessageId], references: [id])
  latestMessageId String?  @unique

  users    User[]
  messages Message[]
}
